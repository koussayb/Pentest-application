import { Box, Modal, Grid, TextField } from "@material-ui/core";
import * as React from "react";
import { makeStyles } from "@material-ui/core/styles";
import LocationCityIcon from "@material-ui/icons/LocationCity";
import LockIcon from "@material-ui/icons/Lock";
import EmailIcon from "@material-ui/icons/Email";
//import axios from "axios";
import "./formulaire.css";
import Button from "@material-ui/core/Button";
import { render } from "@testing-library/react";
import axios from "axios";
import { useHistory } from "react-router-dom";
const style = {
  position: "absolute",
  top: "50%",
  left: "50%",
  transform: "translate(-50%, -50%)",
  width: "40vw",
  bgcolor: "background.paper",
  border: "2px solid #000",
  boxShadow: 24,
  p: 4,
};
const useStyles = makeStyles((theme) => ({
  root: {
    "& > *": {
      margin: theme.spacing(1.5),
      width: "35ch",
    },
  },
}));
function BasicFormulaire({ open, setOpen }) {
  const history = useHistory();

  const handleClose = () => setOpen(false);
  const classes = useStyles();
  const Signup = (event) => {
    event.preventDefault();
    const email = document.getElementById("email2").value;
    const password = document.getElementById("password2").value;
    const name = document.getElementById("name").value;
    const data = {
      email: email,
      password: password,
      name: name,
      id: 0,
    };

    axios.post(`http://127.0.0.1:8000/signup`, data).then((res) => {
      if (res.data.status === 200) {
        localStorage.setItem("token", res.data.access_token);

        history.push("/");
      } else {
        alert(res.data.message);
      }
    });
  };
  const state = {
    selectedFile: null,
  };

  const fileSelectHandler = (event) => {
    this.setState({
      selectedFile: event.target.files[0],
    });
  };
  /*fileUploadHandler = () => {
    axios.post('')
  };*/

  render();

  return (
    <>
      <div>
        <div className="back">
          <Modal
            open={open}
            onClose={handleClose}
            aria-labelledby="modal-modal-title"
            aria-describedby="modal-modal-description"
          >
            <Box sx={style}>
              <form
                className={classes.root}
                noValidate
                autoComplete="off"
              ></form>
              <Grid xs={12} md={8} lg={6} style={{ margin: "auto" }}>
                {/** Nom */}
                <div className={classes.margin}>
                  <Grid
                    container
                    spacing={1}
                    alignItems="flex-end"
                    justifyContent="center"
                  >
                    <Grid item>
                      <LocationCityIcon />
                    </Grid>
                    <Grid item style={{ width: "70%", marginLeft: 5 }}>
                      <TextField
                        style={{ width: "100%" }}
                        id="name"
                        label="Company Name"
                      />
                    </Grid>
                  </Grid>
                </div>

                {/** email */}
                <div className={classes.margin}>
                  <Grid
                    container
                    spacing={1}
                    alignItems="flex-end"
                    justifyContent="center"
                  >
                    <Grid item>
                      <EmailIcon />
                    </Grid>
                    <Grid item style={{ width: "70%", marginLeft: 5 }}>
                      <TextField
                        style={{ width: "100%" }}
                        id="email2"
                        label="Company email"
                        type="email"
                      />
                    </Grid>
                  </Grid>
                </div>
                {/** password */}
                <div className={classes.margin}>
                  <Grid container justifyContent="center" alignItems="flex-end">
                    <Grid item>
                      <LockIcon />
                    </Grid>
                    <Grid item style={{ width: "70%", marginLeft: 5 }}>
                      <TextField
                        style={{ width: "100%" }}
                        id="password2"
                        label="password"
                        type="password"
                      />
                    </Grid>
                  </Grid>
                </div>
              </Grid>
              <div className="send">
                <Button variant="contained" color="primary" onClick={Signup}>
                  Register
                </Button>
              </div>
            </Box>
          </Modal>
        </div>
      </div>
    </>
  );
}

export default BasicFormulaire;
